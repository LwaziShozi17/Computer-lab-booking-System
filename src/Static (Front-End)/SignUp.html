<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Sign Up</title>
    <style>
        *
        body {
            font-family: Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f5f5f5;
        }
        .back-arrow {
            width: 30px;
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: white;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
        }

        .form-box {
            width: 400px;
            border: 1px solid #000;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .form-box h3 {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input {
            width: 95%;
            padding: 10px;
            background-color: #c4c4c4;
            border: none;
            border-radius: 8px;
            font-size: 14px;
        }

        .btn-submit {
            width: 100%;
            background-color: #145a89;
            color: white;
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            justify-content: center;
            margin-top: 20px;
        }

        .btn-submit:hover {
            background-color: #0e4265;
        }
    </style>
</head>
<body>

<!-- Menu icon -->
<img src="https://cdn2.iconfinder.com/data/icons/ui-basic-glyph/512/UI_Basic_GLYPH-80-512.png" alt="Back Arrow" class="back-arrow"/>

<div class="form-box">
    <h3>SIGN UP</h3>
    <form>
        <div class="form-group">
            <label>Student Number</label>
            <input type="text" id="std-number" placeholder="Student Number..." />
        </div>

        <div class="form-group">
            <label>First Name</label>
            <input type="text" id="f-name" placeholder="Your Name..." />
        </div>

        <div class="form-group">
            <label>Last Name</label>
            <input type="text" id="l-name" placeholder="Surname..." />
        </div>

        <div class="form-group">
            <label>Faculty</label>
            <select id="faculty" required style="width: 100%; padding: 10px; background-color: #c4c4c4; border: none; border-radius: 8px; font-size: 14px;">
            <option value="">Select Faculty</option>
            <option value="Engineering">Engineering</option>
            <option value="Information">Informatics and Design</option>
            <option value="Business">Business and Business</option>
        </select>
        </div>

        <div class="form-group">
            <label>Course</label>
            <input type="text" id="course" placeholder="Your Course..." />
        </div>

        <div class="form-group">
            <label>Enrollment Year</label>
            <input type="text" id="enroll-year" placeholder="Your first year..." />
        </div>

        <div class="form-group">
            <label>Current Year</label>
            <select id="current-year" required style="width: 100%; padding: 10px; background-color: #c4c4c4; border: none; border-radius: 8px; font-size: 14px;">
                <option value="">Select Year</option>
                <option value="Year 1">1st Year</option>
                <option value="Year 2">2nd Year</option>
                <option value="Year 3">3rd Year</option>
                <option value="Year 4">4th Year</option>
                <option value="Graduate">Post Graduate</option>
            </select>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" id="std-email" placeholder="Your Student Email..." />
        </div>

        <div class="form-group">
            <label>Create Password</label>
            <input type="password" id="password" placeholder="Password..." />
        </div>

        <div class="form-group">
            <label>Confirm Password</label>
            <input type="password" id="c-password" placeholder="Confirm Password..." />
        </div>

        <button type="submit" class="btn-submit">SIGN UP</button>
    </form>
</div>

<script>

    document.querySelector('.btn-submit').addEventListener('click', function(event) {
        event.preventDefault();

        const formData = {
            studentId: document.getElementById('std-number').value,
            firstName: document.getElementById('f-name').value,
            lastName: document.getElementById('l-name').value,
            faculty: document.getElementById('faculty').value,
            enrollmentYear: document.getElementById('enroll-year').value,
            currentYear: document.getElementById('current-year').value,
            email: document.getElementById('std-email').value,
            password: document.getElementById('password').value
        }

        // Fetch API to register the user
        fetch('http://localhost:8080/cputlibrary.com/http/cputlibrary.com/SignUp', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw err; });
                    }
                    return response.json();
            })
            .then(data => {
                if (data.studentId) {
                    alert("Account linked successfully!");
                    // Redirect to the LogIn page
                    window.location.href = "LogIn.html";
                } else {
                    alert("Failed to register. Please try again.");
                }
            })
            .catch(error => {
                console.error('Error: 3', error.message);
                alert("Error: 2" + error.message || "Already a registered user with this email or student number.");
            });
    });

    document.querySelector('.back-arrow').addEventListener('click', function() {
        window.location.href = 'LogIn.html'; // Redirect to LogIn page
    });

</script>
</body>
</html>
